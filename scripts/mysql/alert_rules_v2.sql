-- MySQL dump 10.16  Distrib 10.1.34-MariaDB, for debian-linux-gnu (x86_64)
--
-- Host: localhost    Database: librenms
-- ------------------------------------------------------
-- Server version	10.1.34-MariaDB-0ubuntu0.18.04.1

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `alert_rules`
--

DROP TABLE IF EXISTS `alert_rules`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `alert_rules` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `rule` text COLLATE utf8_unicode_ci NOT NULL,
  `severity` enum('ok','warning','critical') COLLATE utf8_unicode_ci NOT NULL,
  `extra` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `disabled` tinyint(1) NOT NULL,
  `name` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `query` text COLLATE utf8_unicode_ci NOT NULL,
  `builder` text COLLATE utf8_unicode_ci NOT NULL,
  `proc` varchar(80) COLLATE utf8_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=43 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `alert_rules`
--

LOCK TABLES `alert_rules` WRITE;
/*!40000 ALTER TABLE `alert_rules` DISABLE KEYS */;
INSERT INTO `alert_rules` VALUES (1,'%macros.device_down = \"1\"              ','critical','{\"mute\":false,\"count\":\"1\",\"delay\":60,\"invert\":false,\"interval\":300,\"recovery\":true,\"options\":{\"override_query\":null}}',0,'Devices up/down','SELECT * FROM devices WHERE (devices.device_id = ?) AND (devices.status = 0 && (devices.disabled = 0 && devices.ignore = 0)) = 1','{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_down\",\"field\":\"macros.device_down\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}',''),(2,'%devices.uptime < \"300\" && %macros.device = \"1\"        ','warning','{\"mute\":false,\"count\":\"1\",\"delay\":60,\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Device rebooted','SELECT * FROM devices WHERE (devices.device_id = ?) AND devices.uptime < 300 AND (devices.disabled = 0 && devices.ignore = 0) = 1','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.uptime\",\"field\":\"devices.uptime\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"less\",\"value\":\"300\"},{\"id\":\"macros.device\",\"field\":\"macros.device\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"}],\"valid\":true}',''),(11,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":60,\"invert\":false,\"interval\":300,\"recovery\":true,\"options\":{\"override_query\":null}}',0,'VOSS CPU utilization high','SELECT * FROM devices,processors WHERE (devices.device_id = ? AND devices.device_id = processors.device_id) AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1 AND devices.os = \"voss\" AND processors.processor_usage > 70','{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"processors.processor_usage\",\"field\":\"processors.processor_usage\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"greater\",\"value\":\"70\"}],\"valid\":true}',''),(12,'%macros.device_up = \"1\"  && %devices.sysDescr ~ \"VSP\"       && %mempools.mempool_perc > \"70\" ','warning','{\"mute\":false,\"count\":\"1\",\"delay\":60,\"invert\":false,\"interval\":300,\"recovery\":true,\"options\":{\"override_query\":null}}',0,'VOSS memory utilization high','SELECT * FROM devices,mempools WHERE (devices.device_id = ? AND devices.device_id = mempools.device_id) AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1 AND devices.os = \"voss\" AND mempools.mempool_perc > 70','{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"mempools.mempool_perc\",\"field\":\"mempools.mempool_perc\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"greater\",\"value\":\"70\"}],\"valid\":true}',''),(13,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":60,\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'VOSS Failed Power Supply','SELECT * FROM devices,sensors WHERE (devices.device_id = ? AND devices.device_id = sensors.device_id) AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1 AND devices.os = \"voss\" AND sensors.sensor_type = \"rcChasPowerSupplyOperStatus\" AND sensors.sensor_current = 4','{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"sensors.sensor_type\",\"field\":\"sensors.sensor_type\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"rcChasPowerSupplyOperStatus\"},{\"id\":\"sensors.sensor_current\",\"field\":\"sensors.sensor_current\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"4\"}],\"valid\":true}',''),(21,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":60,\"invert\":false,\"interval\":300,\"recovery\":true,\"options\":{\"override_query\":null}}',0,'Service: VLACP Error','SELECT * FROM devices,services WHERE (devices.device_id = ? AND devices.device_id = services.device_id) AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1 AND services.service_status != 0 AND services.service_type LIKE \'%vlacp%\'','{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"services.service_status\",\"field\":\"services.service_status\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"not_equal\",\"value\":\"0\"},{\"id\":\"services.service_type\",\"field\":\"services.service_type\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"contains\",\"value\":\"vlacp\"}],\"valid\":true}',''),(22,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":60,\"invert\":false,\"interval\":300,\"recovery\":true,\"options\":{\"override_query\":null}}',0,'Service: ISIS Error','SELECT * FROM devices,services WHERE (devices.device_id = ? AND devices.device_id = services.device_id) AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1 AND services.service_status != 0 AND services.service_type LIKE \'%isis%\'','{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"services.service_status\",\"field\":\"services.service_status\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"not_equal\",\"value\":\"0\"},{\"id\":\"services.service_type\",\"field\":\"services.service_type\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"contains\",\"value\":\"isis\"}],\"valid\":true}',''),(23,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":60,\"invert\":false,\"interval\":300,\"recovery\":true,\"options\":{\"override_query\":null}}',1,'Service: MLT Error','SELECT * FROM devices,services WHERE (devices.device_id = ? AND devices.device_id = services.device_id) AND (devices.status = 1 && (devices.disabled = 0 && devices.ignore = 0)) = 1 AND services.service_status != 0 AND services.service_type LIKE \'%mlt%\'','{\"condition\":\"AND\",\"rules\":[{\"id\":\"macros.device_up\",\"field\":\"macros.device_up\",\"type\":\"integer\",\"input\":\"radio\",\"operator\":\"equal\",\"value\":\"1\"},{\"id\":\"services.service_status\",\"field\":\"services.service_status\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"not_equal\",\"value\":\"0\"},{\"id\":\"services.service_type\",\"field\":\"services.service_type\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"contains\",\"value\":\"mlt\"}],\"valid\":true}',''),(25,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: BOSS Stack configuration error','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"boss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg REGEXP \"bsnStackConfigurationError\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"boss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"bsnStackConfigurationError\"}],\"valid\":true}',''),(26,'%syslog.msg ~ \"Connection closed (failed login), IP address\"           && %syslog.timestamp >= %macros.past_5m ','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: BOSS Failed Login Attempt','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"boss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND (syslog.msg REGEXP \"Maximum number of login attempts\" OR syslog.msg REGEXP \"invalid username/password for user\" OR syslog.msg REGEXP \"Failed login(.*) from\")','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"boss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"condition\":\"OR\",\"rules\":[{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"Maximum number of login attempts\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"invalid username/password for user\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"Failed login(.*) from\"}]}],\"valid\":true}',''),(27,'%syslog.msg ~ \"Maximum number of login attempts reached\"                 && %syslog.timestamp >= %macros.past_5m ','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: VOSS Failed Login Attempt','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"voss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg = \"invalid username/password for user\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"invalid username/password for user\"}],\"valid\":true}',''),(28,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: VOSS/BOSS SLPP-guard Error','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND (devices.os = \"boss\" OR devices.os = \"voss\") AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND (syslog.msg REGEXP \"SLPPG:\" OR syslog.msg REGEXP \"due to SLPP-guard\" OR syslog.msg REGEXP \"SLPP-guard INFO SLPP packet received\" OR syslog.msg REGEXP \"INFO SLPP-guard\")','{\"condition\":\"AND\",\"rules\":[{\"condition\":\"OR\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"boss\"},{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"}]},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"condition\":\"OR\",\"rules\":[{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"SLPPG:\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"due to SLPP-guard\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"SLPP-guard INFO SLPP packet received\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"INFO SLPP-guard\"}]}],\"valid\":true}',''),(29,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: VOSS/BOSS SLPP Error','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND (devices.os = \"boss\" OR devices.os = \"voss\") AND syslog.timestamp = (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND (syslog.msg REGEXP \"slppRx:\" OR syslog.msg REGEXP \"due to slpp\" OR syslog.msg REGEXP \"Slpp port down\" OR syslog.msg REGEXP \"SLPP Port Down Event\")','{\"condition\":\"AND\",\"rules\":[{\"condition\":\"OR\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"boss\"},{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"}]},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"`macros.past_5m`\"},{\"condition\":\"OR\",\"rules\":[{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"slppRx:\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"due to slpp\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"Slpp port down\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"SLPP Port Down Event\"}]}],\"valid\":true}',''),(31,'%syslog.timestamp >= %macros.past_5m     && %syslog.msg ~ \"SPBM detected adj DOWN\"             ','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: VOSS SPBM adjacency Down','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"voss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg REGEXP \"SPBM detected adj DOWN\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"SPBM detected adj DOWN\"}],\"valid\":true}',''),(32,'%syslog.timestamp >= %macros.past_5m   && %syslog.msg ~ \"SPBM detected adj UP\" ','ok','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: VOSS SPBM adjacency UP','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"voss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg REGEXP \"SPBM detected adj UP\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"SPBM detected adj UP\"}],\"valid\":true}',''),(34,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: VOSS VLACP pkts sequence number mismatched','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"voss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg REGEXP \"VLACP pkts sequence number mismatched\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"VLACP pkts sequence number mismatched\"}],\"valid\":true}',''),(35,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: VOSS Please clean up /intflash directory to make free space larger','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"voss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg REGEXP \"Please clean up (.*) directory to make free space larger\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"Please clean up (.*) directory to make free space larger\"}],\"valid\":true}',''),(36,'','critical','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: VOSS USB Error','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"voss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg REGEXP \"Lost internal access to USB\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"Lost internal access to USB\"}],\"valid\":true}',''),(37,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog:  VOSS Duplicate IP address','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"voss\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg REGEXP \".*Duplicate IP address.*sent from ethernet address:.*\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"voss\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\".*Duplicate IP address.*sent from ethernet address:.*\"}],\"valid\":true}',''),(41,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: EXOS Login failed','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"xos\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND syslog.msg REGEXP \"Login failed due to invalid\"','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"xos\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"Login failed due to invalid\"}],\"valid\":true}',''),(42,'','warning','{\"mute\":false,\"count\":\"1\",\"delay\":\"0\",\"invert\":false,\"interval\":300,\"recovery\":false,\"options\":{\"override_query\":null}}',0,'Syslog: EXOS ELRP Error','SELECT * FROM devices,syslog WHERE (devices.device_id = ? AND devices.device_id = syslog.device_id) AND devices.os = \"xos\" AND syslog.timestamp >= (DATE_SUB(NOW(),INTERVAL 5 MINUTE)) AND (syslog.msg REGEXP \"Auto re-enable port after\" OR syslog.msg REGEXP \"LOOP DETECTED\")','{\"condition\":\"AND\",\"rules\":[{\"id\":\"devices.os\",\"field\":\"devices.os\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"equal\",\"value\":\"xos\"},{\"id\":\"syslog.timestamp\",\"field\":\"syslog.timestamp\",\"type\":\"datetime\",\"input\":\"text\",\"operator\":\"greater_or_equal\",\"value\":\"`macros.past_5m`\"},{\"condition\":\"OR\",\"rules\":[{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"Auto re-enable port after\"},{\"id\":\"syslog.msg\",\"field\":\"syslog.msg\",\"type\":\"string\",\"input\":\"text\",\"operator\":\"regex\",\"value\":\"LOOP DETECTED\"}]}],\"valid\":true}','');
/*!40000 ALTER TABLE `alert_rules` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2019-05-09  9:32:45
